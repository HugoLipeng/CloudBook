# 关于FloatingX的技术设计指南



# 



基于 DecorView 免权限的悬浮窗方案

- 链式调用，无感知插入
- 支持滑动，自动吸附
- 支持一键隐藏更新
- 支持对指定类显示
- 多指触摸的支持
- 支持自动修复当前显示位置
- 支持自定义显示隐藏动画
- 支持对悬浮窗生命周期的监听
- 支持自定义悬浮窗各项指标
- 悬浮窗位置信息记录
- 支持全局悬浮窗，单个悬浮窗



## 进阶支持

- 支持拖动到顶部或者底部显示回收悬浮窗设计
- 支出与其他悬浮窗联动



#### 不足之处

- view attach时存在闪动 (考虑使用透明动画?)

- view 真实位置即 left,top,right,bottom 没有改变，改变的只是 x,y坐标。

  为什么不实现真实位置改变?

  - 性能
  - 复杂程度
  - 当前的实现足够使用

  要改变一个View的真实位置，有两种方案

  - layout(x,x,x,x)   //addView后，不会保留view原始坐标信息
  - LayoutParams      //相比前者 会保留更改后的数据,需要重新 measure,layout

  上面这两种，在性能方面，都是通过,layout相比后者会性能有所提升，但是需要记录view的位置信息，以及每次不必要的更新位置，复杂

