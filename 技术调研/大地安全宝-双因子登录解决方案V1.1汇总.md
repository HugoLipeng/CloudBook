# 大地安全宝-双因子登录解决方案V1.1汇总

## 什么是双因子登录？

> 双因子认证（2FA）是指结合密码以及实物（信用卡、SMS手机、令牌或指纹等生物
> 标志）两种条件对用户进行认证的方法。

![image-20200914203605581](https://tva1.sinaimg.cn/large/007S8ZIlly1giqgk1baruj30f40660v4.jpg)

**即**：

- ***第一因子(你知道的内容)***
- ***第二因子(你所拥有的物品)***



## 为什么要做双因子登录？

**背景：**适应公司业务的快速迭代，加强登录场景的安全保障。



## 业内经典案例

### 常见第一因子

- 账号密码

### 常见第二因子

- 短信验证码，邮箱验证码，移动端扫码，电子令牌(硬件)，手机令牌(TOTP)，人脸识别

### 阿里云登录案例

![image-20200914235548451](https://tva1.sinaimg.cn/large/007S8ZIlly1giqmbseemxj30d406rt8w.jpg)

![image-20200914235557534](https://tva1.sinaimg.cn/large/007S8ZIlly1giqmbxyae4j30b108wjt1.jpg)



## 安全宝采用的解决方案

动态化配置，根据用户实际需求与所接受成本决定实际因子的分发规则。

**基础原子因子如下：**

- *账号/密码/图形码*
- *手机号/短信码*
- *手机扫码*
- *邮箱验证码*
- *人脸扫描*
- ....

**第二因子触发概率一般通过如下4个维度，当下面4个维度相加<=0.5时 触发 第二因子**：

1. *随机概率 (0~1)*
2. *常用IP (0~0.4)*
3. *常用设备(0~0.4)*
4. *登录次数 ( 0~0.5)*

***上述条件均可配置***



### PC端解决方案

#### PC端因子对应关系：

|     第一因子     |   第二因子    |
| :--------------: | :-----------: |
| 账号/密码/图形码 |     密码      |
|  手机号/短信码   |    短信码     |
|     手机扫码     |   手机扫码    |
|        ——        | 邮箱绑定/校验 |

#### PC端方案流程图：

![image-20200914205143580](https://tva1.sinaimg.cn/large/007S8ZIlly1giqh095b2aj31c70ggq7o.jpg)





### 客户端解决方案

#### 客户端因子对应关系

|     第一因子     | 第二因子 |
| :--------------: | :------: |
| 账号/密码/图形码 |   密码   |
|  手机号/短信码   |  短信码  |
|        ——        | 人脸扫描 |
|        ——        | 邮箱校验 |

#### 客户端方案流程图：

![image-20200915101705806](https://tva1.sinaimg.cn/large/007S8ZIlly1gir4a9cchij31cp0igjw0.jpg)







## 总体流程图如下：

![大地安全宝V1.0](https://tva1.sinaimg.cn/large/007S8ZIlly1gir48xhoebj30vc0u0hdt.jpg)

